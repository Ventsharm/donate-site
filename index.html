<!DOCTYPE html><html><head><meta charset="utf-8"><title>Donate</title><meta name="viewport" content="width=device-width,initial-scale=1"><script src="https://js.stripe.com/v3/"></script><style>body{font-family:sans-serif;text-align:center;padding:40px}button{padding:15px 25px;font-size:18px;cursor:pointer}</style></head><body><h1>Donate £5</h1><button id="donate" type="button">Donate</button><p id="msg" style="margin-top:14px;color:#444"></p><script>const STRIPE_PK="pk_test_51SSCktCoWx432Ea8Wqso4IeICvQ2ZWSFdunUXHg2ENj0hNdc9KSOvYTpy7NwziPqQ2YUWWWXLQHSzcvNeN9AK8Fe00X5L68Dp7";const CHECKOUT_FN="https://europe-west2-donate-app-ff07c.cloudfunctions.net/createCheckout";const stripe=Stripe(STRIPE_PK);const msg=t=>document.getElementById("msg").textContent=t;document.getElementById("donate").addEventListener("click",async()=>{try{msg("Creating checkout…");const r=await fetch(CHECKOUT_FN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:500,currency:"gbp"})});const text=await r.text();let data={};try{data=JSON.parse(text)}catch(e){throw new Error("Function did not return JSON: "+text.slice(0,180))}if(!r.ok)throw new Error(data.error||("HTTP "+r.status));if(!data.url)throw new Error("No checkout URL returned.");msg("Redirecting to Stripe…");location.href=data.url}catch(err){msg("Error: "+err.message);alert("Donate error:\n\n"+err.message)}});</script></body></html>
