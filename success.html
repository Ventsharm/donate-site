<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Success</title><style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#fff}main{max-width:520px;margin:28px auto;padding:18px;text-align:center}h1{font-size:56px;margin:10px 0}p{font-size:18px;opacity:.85}a{color:#111}#box{margin-top:80px}#status{margin-top:12px;font-size:18px;opacity:.9}#small{margin-top:10px;font-size:13px;opacity:.7}</style></head><body><main><div id="box"><div style="font-size:64px">✅</div><h1>Payment received</h1><p>Unlocking your account…</p><div id="status">Waiting for confirmation…</div><div id="small"></div><p style="margin-top:18px"><a href="login.html">Back to login</a></p></div></main><script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script><script>const FIREBASE_CONFIG={apiKey:"PASTE",authDomain:"PASTE",projectId:"PASTE",appId:"PASTE"};firebase.initializeApp(FIREBASE_CONFIG);const auth=firebase.auth(),db=firebase.firestore();const statusEl=document.getElementById("status"),smallEl=document.getElementById("small");auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL).catch(()=>{});function setStatus(t){statusEl.textContent=t;}async function checkPaid(user){const snap=await db.collection("users").doc(user.uid).collection("access").doc("access").get();return !!(snap.exists&&snap.data()&&snap.data().paid===true);}let tries=0,maxTries=12;auth.onAuthStateChanged(async user=>{if(!user){setStatus("Not logged in. Please go back to login.");const pending=localStorage.getItem("pendingUid");if(pending)smallEl.textContent="(Tip: tap Back to login, log in again, then it will unlock.)";return;}try{setStatus("Checking payment…");const ok=await checkPaid(user);if(ok){localStorage.removeItem("pendingUid");setStatus("Confirmed ✅ Redirecting…");location.href="app.html";return;}setStatus("Still not confirmed. Waiting… (1/12)");const timer=setInterval(async()=>{tries++;try{const ok2=await checkPaid(user);if(ok2){clearInterval(timer);localStorage.removeItem("pendingUid");setStatus("Confirmed ✅ Redirecting…");location.href="app.html";return;}setStatus("Still not confirmed. Waiting… ("+(tries+1)+"/12)");}catch(e){setStatus("Error checking payment. Go back to login.");smallEl.textContent=String(e&&e.message?e.message:e);clearInterval(timer);}if(tries>=maxTries){clearInterval(timer);setStatus("Still not confirmed. Go back to login and tap Pay again if needed.");}},2500);}catch(e){setStatus("Error checking payment. Go back to login.");smallEl.textContent=String(e&&e.message?e.message:e);}});</script></body></html>
