<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Success</title><style>body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial,sans-serif;background:#fff;margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;text-align:center} h1{font-size:56px;margin:10px 0} .sub{opacity:.7;font-size:18px} a{display:inline-block;margin-top:14px;font-weight:800;color:#111}</style></head><body><div><div style="font-size:70px">✅</div><h1>Payment received</h1><div class="sub" id="status">Unlocking your account…</div><a href="login.html">Back to login</a></div><script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
import{getAuth,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
import{getFirestore,doc,getDoc}from"https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

const firebaseConfig={apiKey:"AIzaSyBMZo5HOStyDEINl2xLm-M9X4PaDc-raBQ",authDomain:"donate-app-ff07c.firebaseapp.com",projectId:"donate-app-ff07c",storageBucket:"donate-app-ff07c.firebasestorage.app",messagingSenderId:"950201336557",appId:"1:950201336557:web:e8bdfa02d99512051f82e4"};
const app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app);
const status=document.getElementById("status");

async function hasPaid(uid){
  const snap=await getDoc(doc(db,"users",uid));
  return snap.exists() && snap.data()?.paid===true;
}

function wait(ms){return new Promise(r=>setTimeout(r,ms));}

onAuthStateChanged(auth,async(user)=>{
  if(!user){status.textContent="Not logged in. Please go back to login.";return;}
  for(let i=0;i<12;i++){
    status.textContent="Waiting for confirmation… ("+(i+1)+"/12)";
    try{
      if(await hasPaid(user.uid)){location.href="app.html";return;}
    }catch(e){}
    await wait(1500);
  }
  status.textContent="Still not confirmed. Go back to login and tap Pay again if needed.";
});
</script></body></html>
